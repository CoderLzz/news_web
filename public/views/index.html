<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="/assets/lib/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/index.css">
    <link rel="stylesheet" href="/assets/css/common.css">
    <link rel="stylesheet" href="/assets/lib/css/font-awesome.min.css">
    <link rel="stylesheet" href="/assets/lib/css/swiper.min.css">

    <script src="/assets/lib/js/jquery-3.4.1.min.js"></script>
    <script src="/assets/lib/js/bootstrap.min.js"></script>
    <script src="/assets/lib/js/swiper.min.js"></script>
    <script src="/assets/lib/js/template-web.js"></script>
    <title>第一新闻</title>
</head>

<body>
    <div class="container">
        <!-- 头部组件开始 -->
        <div class="row">
            <nav class="navbar navbar-default">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                            data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="index.html">第一新闻</a>
                    </div>
                    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                        <ul class="nav navbar-nav" id="headerNav">
                            
                        </ul>
                        <form class="navbar-form navbar-left">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="输入关键字">
                            </div>
                            <button type="submit" class="btn btn-default">搜索</button>
                        </form>
                        <ul class="nav navbar-nav navbar-right" id="info">
                            <li><a href="login.html">登录</a></li>
                            <li><a href="register.html">注册</a></li>
                        </ul>
                    </div><!-- /.navbar-collapse -->
                </div><!-- /.container-fluid -->
            </nav>
        </div>
        <!-- 头部组件结束 -->
        <div class="row">
            <div class="left col-md-2">
                <!-- logo -->
                <div class="row">
                    <div class="logo">
                        <a href="#">第一新闻</a>
                    </div>
                    <!-- 侧边导航栏 -->
                    <ul class="navMenu clearfix">

                    </ul>
                </div>
            </div>
            <div class="middle col-md-7">
                <div class="row">
                    <!-- 轮播图 -->
                    <div class="swiper-container">

                    </div>
                    <!-- 热门推荐 -->
                    <div class="popular">
                        <div class="title">
                            <h3>热门推荐</h3>
                        </div>
                        <ul class="clearfix popular-upload">

                        </ul>
                    </div>
                    <!-- 最新发布 -->
                    <div class="newest">
                        <div class="title">
                            <h3>最新发布</h3>
                        </div>
                        <div class="main">

                        </div>
                    </div>
                </div>
            </div>
            <div class="right col-md-3">
                <div class="row">
                    <!-- 搜索 -->
                    <div class="search hidden-sm">
                        <div class="title">
                            <h3>搜索</h3>
                        </div>
                        <div class="input clearfix">
                            <input type="text" placeholder="请输入关键字">
                            <button>搜索</button>
                        </div>
                    </div>
                    <!-- 随机推荐 -->
                    <div class="random">
                        <div class="title">
                            <h3>随机推荐</h3>
                        </div>
                        <div class="randomPost">

                        </div>
                    </div>
                    <!-- 最新评论 -->
                    <div class="newComment">
                        <div class="title">
                            <h3>最新评论</h3>
                        </div>
                        <ul class="newContent">

                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 模板部分 -->
    <script type="text/html" id="tpl1">
        {{if username==''}}
        <li><a href="login.html">登录</a></li>
        <li><a href="register.html">注册</a></li>
        {{else if username!=''}}
        <li><a href="javascript:;">{{username}}</a></li>
        <li><a href="javascript:;">{{roleName}}</a></li>
            {{if code!=2&&code!=''}}
                <li><a href="javascript:;" id="gotoBack">去后台</a></li>
            {{/if}}
            <li><a href="javascript:;" id="logout">退出</a></li>
        {{/if}}
    </script>

    <script type="text/html" id="tpl2">
        {{each arr}}
        <li><i class="fa {{$value.cateIcon}}"></i><a href="list.html?id={{$value._id}}">{{$value.cateName}}</a></li>
        {{/each}}
    </script>

    <script type="text/html" id="tpl3">
        <div class="swiper-wrapper">
            {{each swiper}}
            <div class="swiper-slide">
            <a href="detail.html?id={{$value.link._id}}">
                <img src="http://localhost/{{$value.swiper}}" alt="">
            </a>
            <p>{{$value.title}}</p>
            </div>
            {{/each}}
        </div>
        <!-- Add Arrows -->
        <div class="swiper-button-next swiper-btn"></div>
        <div class="swiper-button-prev swiper-btn"></div>
        <!-- Add Pagination -->
        <div class="swiper-pagination"></div>
    </script>
    <script type="text/html" id="tpl4">
        {{each arr}}
        <li>
            <a href="detail.html?id={{$value._id}}">
                <img src="http://localhost/{{$value.cover}}">
                <p>{{$value.title}}</p>
            </a>
        </li>
        {{/each}}
    </script>

    <script type="text/html" id="tpl5">
        {{each arr}}
        <div class="row">
            <div class="col-md-9">
                <div class="main-title">
                    <a href="detail.html?id={{$value._id}}"><i>{{$value.categories.cateName}}</i>{{$value.title}}</a>
                </div>
                <p class="author"><i>{{$value.author.username}}</i>发布于<i>{{$imports.dateFomate($value.uploadDate)}}</i>
                </p>
                <p class="content">
                    {{@$value.content}}
                </p>
                <div class="meta">
                    <i>阅读({{$value.read}})</i>
                    <i>评论({{$value.comment}})</i>
                    <a href="javascript:;"><i class="fa fa-thumbs-up"></i>点赞({{$value.praise}})</a>
                </div>
            </div>
            <div class="col-md-3 cover hidden-xs">
                <a href="javascript:;"><img src="http://localhost/{{$value.cover}}" alt=""></a>
            </div>
        </div>
        {{/each}}
    </script>

    <script type="text/html" id="tpl6">
        {{each arr}}
        <div class="row randomPost">
            <div class="col-md-8">
                <p class="content"><a href="detail.html?id={{$value._id}}">{{$value.title}}</a></p>
                <i>阅读({{$value.read}})</i>
            </div>
            <div class="col-md-4 cover hidden-xs">
                <a href="detail.html?id={{$value._id}}"><img src="http://localhost/{{$value.cover}}" alt=""></a>
            </div>
        </div>
        {{/each}}
    </script>

    <script type="text/html" id="tpl7">
        {{each arr}}
        <li>
            <div class="avatar">
                <img src="http://localhost/{{$value.article.author.avatar}}" alt="">
            </div>
            <div class="content">
                <p class="info"><i class="author">{{$value.author}}</i>于<i>{{$imports.dateFomate($value.createDate)}}</i>说:</p>
                <p class="comment">{{$value.content}}</p>
            </div>
        </li>
        {{/each}}
    </script>

    <script type="text/html" id="tpl12">
        {{each arr1}}
        <li><a href="list.html?id={{$value._id}}">{{$value.cateName}}</a></li>
        {{/each}}
    </script>
    <script src="/assets/js/common.js"></script>
    <script src="/assets/js/index.js"></script>
    <script>
        // var html = template('tpl1', {
        //     username: window.sessionStorage.getItem('username'),
        //     roleName: JSON.parse(window.sessionStorage.getItem('role')).roleName,
        //     code: JSON.parse(window.sessionStorage.getItem('role')).code
        // })
        // document.getElementById('info').innerHTML = html
        // $('#logout').on('click', function () {
        //     window.sessionStorage.clear()
        //     location.href = 'index.html'
        // })
        // $('#gotoBack').on('click', function () {
        //     location.href = "http://localhost:3000/login"
        // })
        // $.ajax({
        //     type: 'get',
        //     url: 'http://localhost/privates/categories',
        //     success: function (data) {
        //         var html = template('tpl2', {
        //             arr: data.data
        //         })
        //         $('.navMenu').html(html)
        //     }
        // })
        // $.ajax({
        //     type: 'get',
        //     url: 'http://localhost/privates/swiper',
        //     success: function (data) {
        //         var html = template('tpl3', {
        //             swiper: data.data
        //         })
        //         $('.swiper-container').html(html)
        //         var swiper = new Swiper('.swiper-container', {
        //             slidesPerView: 1,
        //             spaceBetween: 30,
        //             loop: true,
        //             pagination: {
        //                 el: '.swiper-pagination',
        //                 clickable: true,
        //             },
        //             navigation: {
        //                 nextEl: '.swiper-button-next',
        //                 prevEl: '.swiper-button-prev',
        //             },
        //             autoplay: {
        //                 delay: 2500,
        //                 disableOnInteraction: false,
        //             },
        //         });
        //     }
        // })
        // // 每个30s重新获取
        // $.ajax({
        //     type: 'get',
        //     url: 'http://localhost/privates/popular',
        //     success: function (data) {
        //         let postArr = new Set()
        //         while (postArr.size < 4) {
        //             var num = rd(data.data.length, 0)
        //             postArr.add(data.data[num])
        //         }
        //         var html = template('tpl4', {
        //             arr: [...postArr]
        //         })
        //         $('.popular-upload').html(html)
        //     }
        // })

        // $.ajax({
        //     type: 'get',
        //     url: 'http://localhost/privates/newest',
        //     success: function (data) {
        //         var html = template('tpl5', {
        //             arr: data.data
        //         })
        //         $('.newest .main').html(html)
        //     }
        // })

        // $.ajax({
        //     type: 'get',
        //     url: 'http://localhost/privates/randomPost',
        //     success: function (data) {
        //         let randomPost = new Set()
        //         while (randomPost.size <= 2) {
        //             var num = rd(data.data.length, 0)
        //             randomPost.add(data.data[num])
        //         }
        //         var html = template('tpl6', {
        //             arr: [...randomPost]
        //         })
        //         $('.random .randomPost').html(html)
        //     }
        // })
    
        // $.ajax({
        //     type:'get',
        //     url:'http://localhost/privates/newComment',
        //     success:function(data){
        //         var html=template('tpl7',{
        //             arr:data.data
        //         })
        //         $('.newContent').html(html)
        //     }
        // })
    </script>
</body>

</html>